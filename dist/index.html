<!DOCTYPE html>
<html>
  <head>
      <title>VideoRecorder Test</title>
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">
      <style>
        #console {
          font-family: monospace;
          background-color: #DDD;

        }
        #console p {
          margin-bottom: 2px;
        }
      </style>
  </head>
  <body>  
    <div class="container">
    <div class="row">Current state of recorder: <em id="state">inactive</em></div>
    <div class="row">
      <div class="col-xs-4 col-xs-offset-2">
        <video id="video"></video>
      </div>      
    </div>
    <div style="text-align:center" class="row">
      <button type="button" class="btn btn-primary" id="start">Start Recording</button>
      <button type="button" class="btn btn-primary" id="pause">Pause Recording</button>
      <button type="button" class="btn btn-primary" id="resume">Resume Recording</button>
      <button type="button" class="btn btn-primary" id="stop">Stop Recording</button>
    </div>
    <div class="row">
      <p><a href="#" id="downloadLink">Download</a></p>
    </div>

    <div id="console" class=" col-md-6 row">
    </div>

    </div>
    <script src="main.js"></script>
    <script type="text/javascript">
    (function() {
      var oldLog = console.log;
      console.log = function(message) {
        var p = document.createElement('p');
        p.innerHTML = '- ' +message;
        document.getElementById('console').appendChild(p);
        oldLog.apply(console, arguments);
      };
    })();



      var options = {
        selector: '#video',
        height: 480,
        width: 640,
        logging: true,
      };
      var recorder = new Shutter(options);
      recorder.getUserMedia();
      
      document.getElementById('start').addEventListener('click', function() {
        recorder.start();
      });
      document.getElementById('pause').addEventListener('click', function() {
        recorder.pause();
      });
      document.getElementById('resume').addEventListener('click', function() {
        recorder.resume();
      });
      document.getElementById('stop').addEventListener('click', function() {
        recorder.stop(function(url) {
          document.getElementById('video').src = url;
          document.getElementById('video').controls = true;

          var link = document.getElementById('downloadLink');
          link.href = url;
          link.download = 'video.webm';
        });
      });

</script>
  </body>
</html>